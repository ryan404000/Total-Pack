#Category only allowed for SOV
SOV_great_patriotic_war = {

	SOV_civilian_evacuation = {

		available = {
			NOT = {
				206 = { is_controlled_by_ROOT_or_ally = yes }
				202 = { is_controlled_by_ROOT_or_ally = yes }
				242 = { is_controlled_by_ROOT_or_ally = yes }
				137 = { is_controlled_by_ROOT_or_ally = yes }
				203 = { is_controlled_by_ROOT_or_ally = yes }
				226 = { is_controlled_by_ROOT_or_ally = yes }
			}
		}
		allowed = {
			tag = SOV
		}
		activation = {
			SOV = { has_war_with = GER }
		}	
		
		days_mission_timeout = 15

		icon = generic_scorched_earth

		fire_only_once = yes
		
		is_good = yes		

		timeout_effect = {
			206 = { # minsk
				add_manpower = -750000
			}
			252 = { # gorki
				add_manpower = 750000
			}
			202 = { # kiev
				add_manpower = -2000000
			}
			250 = {
				add_manpower = 2000000
			}
			242 = { 
				add_manpower = -500000
			}
			572 = {
				add_manpower = 500000
			}
			137 = {
				add_manpower = -500000
			}
			582 = {
				add_manpower = 500000
			}
			203 = { # cherkasy
				add_manpower = -1000000
			}
			653 = { 
				add_manpower = 1000000
			}
			226 = { # dnipropetrovsk
				add_manpower = -1000000
			}
			403 = {
				add_manpower = 1000000
			}
		}
	}

	SOV_JAP_war = {

		available = {
			SOV = { has_war_with = GER }
			has_global_flag = JAP_prepare_war
			surrender_progress > 0.1
			NOT = { has_war_with = JAP }
			has_completed_focus = SOV_fareast
			408 = { is_controlled_by_ROOT_or_ally = yes }
			409 = { is_controlled_by_ROOT_or_ally = yes }
			657 = { is_controlled_by_ROOT_or_ally = yes }
			561 = { is_controlled_by_ROOT_or_ally = yes }
			563 = { is_controlled_by_ROOT_or_ally = yes }
		}
		allowed = {
			tag = SOV
		}
		visible = {
			JAP = {
				or = {
					has_completed_focus = JAP_control_pacific
					has_completed_focus = JAP_Northern
				}
			}
		}

		icon = decision_generic_SOV

		cost = 0
		ai_will_do = {
			factor = 5000
		}	
		fire_only_once = yes

		complete_effect = {
			hidden_effect = {
				load_oob = SOV_japan
			}
			custom_effect_tooltip = SOV_japan_units
			add_ideas = SOV_patriotic
		}
	}
	
	SOV_destroysiberia2 = {

		available = {
			SOV = { has_war_with = GER }
			has_global_flag = JAP_prepare_war
			surrender_progress > 0.1
			has_completed_focus = SOV_destroysiberia
			408 = { is_controlled_by_ROOT_or_ally = yes }
			409 = { is_controlled_by_ROOT_or_ally = yes }
			657 = { is_controlled_by_ROOT_or_ally = yes }
			561 = { is_controlled_by_ROOT_or_ally = yes }
			563 = { is_controlled_by_ROOT_or_ally = yes }
		}
		allowed = {
			tag = SOV
		}
		visible = {
			JAP = {
				or = {
					has_completed_focus = JAP_control_pacific
					has_completed_focus = JAP_Northern
				}
			}
		}

		icon = generic_scorched_earth

		cost = 0
		ai_will_do = {
			factor = 5000
		}	
		fire_only_once = yes

		complete_effect = {
			408 = {
				damage_building = {
					type = infrastructure
					damage = 3
				}
			}
			409 = {
				damage_building = {
					type = infrastructure
					damage = 3
				}
			}
			657 = {
				damage_building = {
					type = infrastructure
					damage = 3
				}
			}
			561 = {
				damage_building = {
					type = infrastructure
					damage = 3
				}
			}
			563 = {
				damage_building = {
					type = infrastructure
					damage = 3
				}
			}
			564 = {
				damage_building = {
					type = infrastructure
					damage = 3
				}
			}
			566 = {
				damage_building = {
					type = infrastructure
					damage = 3
				}
			}
			567 = {
				damage_building = {
					type = infrastructure
					damage = 3
				}
			}
		}
	}

	SOV_lessons_of_war_decision = {

		available = {
			SOV = { has_war_with = GER }
			AND = {
		    	surrender_progress > 0.04
                casualties > 1000000
			}
            #custom_trigger_tooltip = { tooltip = barba_1
			#	check_variable = {
			#			var = global.ostfront_year_4
			#			value = 1
			#			compare = greater_than_or_equals
			#	}
			#}
		}
		allowed = {
			tag = SOV
		}
		#visible = {
		#	has_idea = Disorganized_Red_Army_1
		#}
		
		activation = {
			has_idea = Disorganized_Red_Army_1
		}		
		
		days_mission_timeout = 120	

		icon = decision_generic_SOV

		#cost = 0
		#ai_will_do = {
		#	factor = 100000
		#}	
		fire_only_once = yes
		is_good = yes		
		timeout_effect = {
			swap_ideas = {
				remove_idea = Disorganized_Red_Army_1
				add_idea = Disorganized_Red_Army_2
			}
			custom_effect_tooltip = SOV_unitslessons
			hidden_effect = {
				load_oob = "SOV_proletariat"
				random_owned_controlled_state = {
					prioritize = { 242 }
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
				}
				random_owned_controlled_state = {
					prioritize = { 209 }
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
				}
				random_owned_controlled_state = {
					prioritize = { 221 }
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
				}
			}
		}
		complete_effect = {
			swap_ideas = {
				remove_idea = Disorganized_Red_Army_1
				add_idea = Disorganized_Red_Army_2
			}
			custom_effect_tooltip = SOV_unitslessons
			hidden_effect = {
				load_oob = "SOV_proletariat"
				random_owned_controlled_state = {
					prioritize = { 242 }
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
				}
				random_owned_controlled_state = {
					prioritize = { 209 }
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
				}
				random_owned_controlled_state = {
					prioritize = { 221 }
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
				}
			}
		}
	}
	SOV_lessons_of_war2_decision = {

		available = {
			SOV = { has_war_with = GER }
			AND  = {
		    	surrender_progress > 0.08
                casualties > 1600000
			}
            #custom_trigger_tooltip = { tooltip = barba_2
			#check_variable = {
			#			var = global.ostfront_year_4
			#			value = 3
			#			compare = greater_than_or_equals
			#}
			#}
		}
		allowed = {
			tag = SOV
		}
		#visible = {
		#	has_idea = Disorganized_Red_Army_2
		#}

		activation = {
			has_idea = Disorganized_Red_Army_2
		}	
		
		days_mission_timeout = 120	

		icon = decision_generic_SOV

		#cost = 0
		#ai_will_do = {
		#	factor = 100000
		#}	
		fire_only_once = yes
		is_good = yes		
		
		timeout_effect = {
			swap_ideas = {
				remove_idea = Disorganized_Red_Army_2
				add_idea = Disorganized_Red_Army_3
			}
			custom_effect_tooltip = SOV_unitslessons
			hidden_effect = {
				random_owned_controlled_state = {
					prioritize = { 242 }
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
				}
				random_owned_controlled_state = {
					prioritize = { 209 }
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
				}
				random_owned_controlled_state = {
					prioritize = { 221 }
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
				}
			}
		}
		complete_effect = {
			swap_ideas = {
				remove_idea = Disorganized_Red_Army_2
				add_idea = Disorganized_Red_Army_3
			}
			custom_effect_tooltip = SOV_unitslessons
			hidden_effect = {
				random_owned_controlled_state = {
					prioritize = { 242 }
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
				}
				random_owned_controlled_state = {
					prioritize = { 209 }
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
				}
				random_owned_controlled_state = {
					prioritize = { 221 }
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
				}
			}
		}
	}

	SOV_lessons_of_war3_decision = {

	available = {
			SOV = { has_war_with = GER }
			AND = {
		    	surrender_progress > 0.12
                casualties > 2750000
			}
            #custom_trigger_tooltip = { tooltip = barba_3
			#check_variable = {
			#			var = global.ostfront_year_4
			#			value = 4
			#			compare = greater_than_or_equals
			#}
			#}
		}
		allowed = {
			tag = SOV
		}
		#visible = {
		#	has_idea = Disorganized_Red_Army_3
		#}
		activation = {
			has_idea = Disorganized_Red_Army_3
		}	

		days_mission_timeout = 120			

		icon = decision_generic_SOV

		#cost = 0
		#ai_will_do = {
		#	factor = 100000
		#}	
		fire_only_once = yes
		is_good = yes		

		timeout_effect = {
			swap_ideas = {
				remove_idea = Disorganized_Red_Army_3
				add_idea = Disorganized_Red_Army_4
			}
			custom_effect_tooltip = SOV_unitslessons
			hidden_effect = {
				random_owned_controlled_state = {
					prioritize = { 219 }
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
				}
				random_owned_controlled_state = {
					prioritize = { 263 }
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
				}
				random_owned_controlled_state = {
					prioritize = { 217 }
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
				}
			}
		}
		complete_effect = {
			swap_ideas = {
				remove_idea = Disorganized_Red_Army_3
				add_idea = Disorganized_Red_Army_4
			}
			custom_effect_tooltip = SOV_unitslessons
			hidden_effect = {
				random_owned_controlled_state = {
					prioritize = { 219 }
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
				}
				random_owned_controlled_state = {
					prioritize = { 263 }
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
				}
				random_owned_controlled_state = {
					prioritize = { 217 }
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
				}
			}
		}
	}

	SOV_lessons_of_war4_decision = {

		available = {
			SOV = { has_war_with = GER }
			AND  = {
		    	surrender_progress > 0.16
                casualties > 3500000
			}
            #custom_trigger_tooltip = { tooltip = barba_3
			#check_variable = {
			#			var = global.ostfront_year_4
			#			value = 4
			#			compare = greater_than_or_equals
			#}
			#}
		}
		allowed = {
			tag = SOV
		}
		#visible = {
		#	has_idea = Disorganized_Red_Army_4
		#}
		
		activation = {
			has_idea = Disorganized_Red_Army_4
		}	
		
		days_mission_timeout = 120			

		icon = decision_generic_SOV

		#cost = 0
		#ai_will_do = {
		#	factor = 100000
		#}	
		fire_only_once = yes
		is_good = yes		
		
		timeout_effect = {
			swap_ideas = {
				remove_idea = Disorganized_Red_Army_4
				add_idea = Disorganized_Red_Army_5
			}
			custom_effect_tooltip = SOV_unitslessons
			hidden_effect = {
				random_owned_controlled_state = {
					prioritize = { 219 }
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
				}
				random_owned_controlled_state = {
					prioritize = { 263 }
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
				}
				random_owned_controlled_state = {
					prioritize = { 217 }
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
				}
			}
		}
		complete_effect = {
			swap_ideas = {
				remove_idea = Disorganized_Red_Army_4
				add_idea = Disorganized_Red_Army_5
			}
			custom_effect_tooltip = SOV_unitslessons
			hidden_effect = {
				random_owned_controlled_state = {
					prioritize = { 219 }
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
				}
				random_owned_controlled_state = {
					prioritize = { 263 }
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
				}
				random_owned_controlled_state = {
					prioritize = { 217 }
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
				}
			}
		}
	}
	SOV_lessons_of_war5_decision = {
		available = {
			SOV = { has_war_with = GER }
			AND  = {
		    	surrender_progress > 0.2
                casualties > 4500000
			}
            #custom_trigger_tooltip = { tooltip = barba_3
			#check_variable = {
			#			var = global.ostfront_year_4
			#			value = 4
			#			compare = greater_than_or_equals
			#}
			#}
		}
		allowed = {
			tag = SOV
		}
		#visible = {
		#	has_idea = Disorganized_Red_Army_5
		#}
		activation = {
			has_idea = Disorganized_Red_Army_5
		}	
		days_mission_timeout = 120			
		icon = decision_generic_SOV
		#cost = 0
		#ai_will_do = {
		#	factor = 100000
		#}	
		fire_only_once = yes
		is_good = yes		

		timeout_effect = {
			add_tech_bonus = {
				name = land_doctrine_bonus
				bonus = 0.4
				category = land_doctrine
			}
			if = { limit = { has_idea = Disorganized_Red_Army_5 } remove_ideas = Disorganized_Red_army_5 }
			custom_effect_tooltip = SOV_unitslessons
			hidden_effect = {
				random_owned_controlled_state = {
					prioritize = { 219 }
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
				}
				random_owned_controlled_state = {
					prioritize = { 263 }
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
				}
				random_owned_controlled_state = {
					prioritize = { 217 }
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
				}
			}
		}
		complete_effect = {
			add_tech_bonus = {
				name = land_doctrine_bonus
				bonus = 0.4
				category = land_doctrine
			}
			if = { limit = { has_idea = Disorganized_Red_Army_5 } remove_ideas = Disorganized_Red_army_5 }
			custom_effect_tooltip = SOV_unitslessons
			hidden_effect = {
				random_owned_controlled_state = {
					prioritize = { 219 }
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
				}
				random_owned_controlled_state = {
					prioritize = { 263 }
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
				}
				random_owned_controlled_state = {
					prioritize = { 217 }
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
					create_unit = { 
						division = "name = \"Proletariat division\" division_template = \"Proletariat division\" start_experience_factor = 0.1" 
						owner = SOV
					}
				}
			}
		}
	}
	#SOV_lessons_of_war6_decision = {
	#	available = {
	#		SOV = { has_war_with = GER }
	#		has_army_experience > 200
	#		casualties > 2000000
	#		custom_trigger_tooltip = { tooltip = barba_12 
	#		check_variable = {
	#					var = global.ostfront_year_4
	#					value = 13
	#					compare = greater_than_or_equals
	#		}
	#		
	#		}
	#	}
	#	allowed = {
	#		tag = SOV
	#	}
	#	visible = {
	#		OR = { 
	#		has_idea = Disorganized_Red_Army_1
	#		has_idea = Disorganized_Red_Army_2
	#		has_idea = Disorganized_Red_Army_3
	#		has_idea = Disorganized_Red_Army_4
	#		has_idea = Disorganized_Red_Army_5
	#		}
	#	}
	#	icon = decision_generic_SOV
	#	cost = 25
	#	ai_will_do = {
	#		factor = 100000
	#	}	
	#	fire_only_once = yes
	#	complete_effect = {
	#		army_experience = -200
	#		if = { limit = { has_idea = Disorganized_Red_Army_1 } remove_ideas = Disorganized_Red_army_1 }
	#		if = { limit = { has_idea = Disorganized_Red_Army_2 } remove_ideas = Disorganized_Red_army_2 }
	#		if = { limit = { has_idea = Disorganized_Red_Army_3 } remove_ideas = Disorganized_Red_army_3 }
	#		if = { limit = { has_idea = Disorganized_Red_Army_4 } remove_ideas = Disorganized_Red_army_4 }
	#		if = { limit = { has_idea = Disorganized_Red_Army_5 } remove_ideas = Disorganized_Red_army_5 }
	#	}
	#}

winter_offensive_decision = { #1941-42 winter
	allowed = {
			original_tag = SOV
		}
	available = {
		tag = SOV
		has_war_with = GER
		has_capitulated = no		
		or = { AND = { date > 1940.11.29 date < 1941.01.20 } AND = { date > 1941.11.29 date < 1942.01.20} AND = { date > 1942.11.29 date < 1943.01.20} AND = { date > 1943.11.29 date < 1944.01.20 } AND = { date > 1944.11.29 date < 1945.01.20} }
		controls_state = 219
		# german advance check 
		OR = {
		NOT = { SOV = { has_full_control_of_state = 202 }}
		NOT = { SOV = { has_full_control_of_state = 206 }}
		NOT = { SOV = { has_full_control_of_state = 12 }}
		NOT = {
			GER = {
				controls_state = 219
			}
		}
		}
	}


	visible = {
	    has_war_with = GER
		or = { AND = { date > 1940.9.29 date < 1941.01.20 } AND = { date > 1941.9.29 date < 1942.01.20} AND = { date > 1942.9.29 date < 1943.01.20} AND = { date > 1943.9.29 date < 1944.01.20 } AND = { date > 1944.9.29 date < 1945.01.20} }
		OR = { NOT = { has_country_flag = SOVwintercounteroffense } NOT = { has_country_flag = SOVwintercounteroffense2 } }
	}
	icon = GFX_decision_soviet

		cost = 0
		ai_will_do = {
			factor = 100
		}	
		fire_only_once = yes
	
	complete_effect = {
		custom_effect_tooltip = SOV_winteroffensive1_tt
		custom_effect_tooltip = SOV_winteroffensive2_tt
		hidden_effect = {
			SOV = {
				country_event = {
					id = soviet.389
					hours = 1
				}
			}	
			set_country_flag = SOVwintercounteroffense
			news_event = { 
				hours = 20 
				id = worldnews.8 
			}
		}
		if = {
			limit = {
				is_ai = yes
			}
			add_timed_idea = {	
				idea = winter_offensive
				days = 70
			}
		}	
		else = {
			add_timed_idea = {	
				idea = winter_offensive
				days = 55
			}
		}
		if = { 
			limit = { OR = { is_ai = no has_global_flag = ai_speeches } } 
			hidden_effect = {
				play_song = "The Cossacks"
				sound_effect = sp_sov_winteroffensive
			}
		}
		
		
    }
}
	
winter_offensive_decision_2 = { #1942-43 saturn
allowed = {
			original_tag = SOV
		}
	available = {
		tag = SOV
		NOT = { has_idea = winter_offensive }
		has_war_with = GER
		has_capitulated = no	
		has_country_flag = SOVwintercounteroffense
		or = {  AND = { date > 1942.10.29 date < 1943.01.20} AND = { date > 1943.10.29 date < 1944.01.20 } AND = { date > 1944.10.29 date < 1945.01.20} }
	}
	visible = {
		NOT = { has_country_flag = SOVwintercounteroffense2 }
	    NOT = { has_idea = winter_offensive }
		has_country_flag = SOVwintercounteroffense
	    has_war_with = GER
	}

	icon = GFX_decision_soviet
	cost = 0
		ai_will_do = {
			factor = 500
		}	
		fire_only_once = yes
	
	complete_effect = { 
	   	
		if = {
			limit = {
				is_ai = yes
			}
			add_timed_idea = {	
       		idea = winter_offensive2
	   		days = 120
	     	}
		}
		else = {
	    	add_timed_idea = {	
       	    	idea = winter_offensive2
	     		days = 100
	     	}
		}
		set_country_flag = SOVwintercounteroffense2
		news_event = { hours = 20 id = news.1301 }
		if = { 
			limit = { OR = { is_ai = no has_global_flag = ai_speeches } } 
			hidden_effect = {
				play_song = "Tatchanka"
			}
		}
	}
} 

winter_offensive_decision_3 = { #campaign of 1943-44
allowed = {
			original_tag = SOV
		}
	available = {
		tag = SOV
		NOT = { has_idea = winter_offensive2 }
		has_war_with = GER
		has_capitulated = no		
		or = { AND = { date > 1940.9.29 date < 1941.01.20 } AND = { date > 1941.9.29 date < 1942.01.20} AND = { date > 1942.9.29 date < 1943.01.20} AND = { date > 1943.9.29 date < 1944.01.20 } AND = { date > 1944.11.29 date < 1945.01.20} }
		# german advance check
		#NOT = { SOV = { has_full_control_of_state = 202 }}
		#NOT = { SOV = { has_full_control_of_state = 206 }}
	}

	visible = {
	        NOT = { has_idea = winter_offensive2 }
			has_country_flag = SOVwintercounteroffense2
			NOT = { has_country_flag = SOVwintercounteroffense3 }
	        has_war_with = GER
		or = { AND = { date > 1940.8.29 date < 1941.01.20 } AND = { date > 1941.8.29 date < 1942.01.20} AND = { date > 1942.8.29 date < 1943.01.20} AND = { date > 1943.8.29 date < 1944.01.20 } AND = { date > 1944.8.29 date < 1945.01.20} }
	}
	icon = GFX_decision_soviet
	cost = 0
	ai_will_do = {
		factor = 500
	}	
	fire_only_once = yes
	
	complete_effect = { 
		set_country_flag = SOVwintercounteroffense3
		news_event = { hours = 20 id = news.1302 }
		
	   	if = {
			limit = {
				is_ai = yes
			}
			add_timed_idea = {	
				idea = winter_offensive3
				days = 120
			}
		}	
		else = {
			add_timed_idea = {	
				idea = winter_offensive3
				days = 100
			}
		}
		if = { 
			limit = { OR = { is_ai = no has_global_flag = ai_speeches } } 
			hidden_effect = {
				play_song = "We Are The Red Army Cavalry"
			}
		}
	}
}

winter_offensive_decision_4 = { #Campaign of 1944/1945 Bagration
allowed = {
			original_tag = SOV
		}
	available = {
		tag = SOV
		NOT = { has_idea = winter_offensive3 }
		has_war_with = GER
		has_capitulated = no
		or = { AND = { date > 1940.7.1 date < 1941.01.1 } AND = { date > 1941.7.1 date < 1942.01.1} AND = { date > 1942.7.1 date < 1943.01.1} AND = { date > 1943.7.1 date < 1944.01.1 } AND = { date > 1944.7.1 date < 1945.01.1} }
		# german advance check
		#NOT = { SOV = { has_full_control_of_state = 202 }}
		#NOT = { SOV = { has_full_control_of_state = 206 }}
	}
	visible = {
	        NOT = { has_idea = winter_offensive2 }
			has_country_flag = SOVwintercounteroffense3
			has_war_with = GER
		or = { AND = { date > 1940.8.1 date < 1941.01.20 } AND = { date > 1941.8.1 date < 1942.01.20} AND = { date > 1942.8.1 date < 1943.01.20} AND = { date > 1943.8.1 date < 1944.01.20 } AND = { date > 1944.8.1 date < 1945.01.20} }
	}
	icon = GFX_decision_soviet
	cost = 0
	ai_will_do = {
		factor = 500
	}	
	fire_only_once = yes
	
	complete_effect = { 
		news_event = { hours = 20 id = news.1303 }
	   	if = {
			limit = {
				is_ai = yes
			}
			add_timed_idea = {	
				idea = winter_offensive4
				days = 125
			}
		}
		
		else = {
			add_timed_idea = {	
				idea = winter_offensive4
				days = 110
			}
		}
		if = { 
			limit = { OR = { is_ai = no has_global_flag = ai_speeches } } 
			hidden_effect = {
				play_song = "Smuglianka"
			}
		}
	}
}

	SOV_order_227 = {

		icon = generic_army_support

		available = {
			has_war = yes
			any_enemy_country = {
				num_of_factories > 100
			}
			has_civil_war = no
			has_capitulated = no
			or = {
				surrender_progress > 0.4
				and = {
					date > 1942.5.20
					surrender_progress > 0.25
				}
			}
		}

		cost = 40
		fire_only_once = yes
		visible = {
			has_war = yes
			any_enemy_country = {
				num_of_factories > 100
			}
		}
		
		modifier = {
			
		}
		complete_effect ={
			if = { limit = { OR = { is_ai = no has_global_flag = ai_speeches } } 
				hidden_effect = {
					sound_effect = sp_sov_invinciblearmy 
				}
			}
			add_timed_idea = {
				idea = SOV_order227 # moved it to the national spirit so GER can see it
				days = 280
			}
		}
		ai_will_do = {
			factor = 500
		}
	}
	
	SOV_evacuate_moscow = {

		icon = generic_army_support

		available = {
			has_war = yes
			any_enemy_country = {
				num_of_factories > 100
			}
			has_civil_war = no
			OR = {
			    surrender_progress > 0.3 
				207 = { CONTROLLER = { has_war_with = SOV } }
				210 = { CONTROLLER = { has_war_with = SOV } }
				241 = { CONTROLLER = { has_war_with = SOV } }
				193 = { CONTROLLER = { has_war_with = SOV } }
				225 = { CONTROLLER = { has_war_with = SOV } }
				240 = { CONTROLLER = { has_war_with = SOV } }
			}
		}

		cost = 10
		fire_only_once = yes
		visible = {
			has_war = yes
			any_enemy_country = {
				num_of_factories > 100
			}
			surrender_progress > 0.1 
		}
		

		complete_effect ={
		    set_capital = 653
	    	set_country_flag = SOV_capital_moved
			add_stability = -0.05
			653 = {
				add_building_construction = {
					type = infrastructure
					level = 1
					instant_build = yes
				}
			}			
		}
		ai_will_do = {
			factor = 100
			modifier = {
				factor = 0
				GER = { 
					NOT = { 
						controls_state = 223
						controls_state = 205
						controls_state = 246
						controls_state = 247
						controls_state = 248
						controls_state = 253
						controls_state = 254
					}
				}
			}
		}
	}
	
	SOV_reinstate_moscow = {

		icon = generic_army_support

		available = {
			surrender_progress < 0.2 
		    219 = { is_fully_controlled_by = SOV }
			has_country_flag = SOV_capital_moved
		}

		cost = 10
		fire_only_once = yes
		visible = {
			has_war = yes
			any_enemy_country = {
				num_of_factories > 100
			}
			surrender_progress > 0.1 
		}
		

		complete_effect ={
		    set_capital = 219
	    	set_country_flag = SOV_capital_moved
			add_war_support = -0.05
			add_stability = -0.05
		}
		ai_will_do = {
			factor = 100
			modifier = {
				factor = 0
				GER = { 
					controls_state = 223
					controls_state = 205
					controls_state = 246
					controls_state = 247
					controls_state = 248
					controls_state = 253
					controls_state = 254
				}
			}
		}
	}
	
	SOV_scorched_earth = {

		icon = generic_scorched_earth

		available = {
			has_war = yes
			any_enemy_country = {
				num_of_factories > 100
			}
			#surrender_progress > 0
		}

		cost = 0
		fire_only_once = yes
		visible = {
			has_war = yes
			any_enemy_country = {
				num_of_factories > 100
			}
			#surrender_progress > 0
		}

		complete_effect = {
			set_country_flag = SOV_scorched_earth
		}

		ai_will_do = {
			factor = 500
		}
	}
	SOV_scorched_earth_baltics = {

		icon = generic_scorched_earth
		
		highlight_state_targets = {
			state = 11
		}

		available = {
			has_war = yes
			has_country_flag = SOV_scorched_earth
			OR = {
				controls_state = 189
				controls_state = 11
				controls_state = 190
				controls_state = 784
			}
		}

		cost = 0
		fire_only_once = yes
		visible = {
			has_war = yes
			has_country_flag = SOV_scorched_earth
		}

		complete_effect = {
			if = {
				limit = {
					controls_state = 189
				}
				189 = {
					damage_building = {
						type = infrastructure
						damage = 2
					}
				}
			}
			if = {
				limit = {
					controls_state = 11
				}
				11 = {
					damage_building = {
						type = infrastructure
						damage = 2
					}
				}
			}
			if = {
				limit = {
					controls_state = 190
				}
				190 = {
					damage_building = {
						type = infrastructure
						damage = 2
					}
				}
			}
			if = {
				limit = {
					controls_state = 784
				}
				784 = {
					damage_building = {
						type = infrastructure
						damage = 2
					}
				}
			}
		}

		ai_will_do = {
			factor = 500
		}
	}
	SOV_scorched_earth_baltics2 = {

		icon = generic_scorched_earth
		
		highlight_state_targets = {
			state = 12
			state = 191
			state = 13
		}

		available = {
			has_war = yes
			has_country_flag = SOV_scorched_earth
			OR = {
				controls_state = 12
				controls_state = 191
				controls_state = 13
			}
		}

		cost = 0
		fire_only_once = yes
		visible = {
			has_war = yes
			has_country_flag = SOV_scorched_earth
		}

		complete_effect = {
			if = {
				limit = {
					controls_state = 12
				}
				12 = {
					damage_building = {
						type = infrastructure
						damage = 3
					}
				}
			}
			if = {
				limit = {
					controls_state = 191
				}
				191 = {
					damage_building = {
						type = infrastructure
						damage = 3
					}
				}
			}
			if = {
				limit = {
					controls_state = 13
				}
				13 = {
					damage_building = {
						type = infrastructure
						damage = 3
					}
				}
			}
		}

		ai_will_do = {
			factor = 500
		}
	}
	SOV_scorched_earth_byelorussia = {

		icon = generic_scorched_earth
		
		highlight_state_targets = {
			state = 94
			state = 95
			state = 96	
			state = 97
		}

		available = {
			has_war = yes
			has_country_flag = SOV_scorched_earth
			any_state = {
				is_core_of = BLR
				is_controlled_by = SOV
				NOT = {
					state = 206
					state = 204
					state = 207
					state = 194
					state = 241
				}
			}
		}

		cost = 0
		fire_only_once = yes
		visible = {
			has_war = yes
			has_country_flag = SOV_scorched_earth
		}

		complete_effect = {
			every_state = {
				limit = {
					is_core_of = BLR
					is_controlled_by = SOV
					NOT = {
						state = 206
						state = 204
						state = 207
						state = 194
						state = 241
					}
				}
				damage_building = {
					type = infrastructure
					damage = 2
				}
			}
		}

		ai_will_do = {
			factor = 500
		}
	}
	SOV_scorched_earth_byelorussia2 = {

		icon = generic_scorched_earth
		
		highlight_state_targets = {
			state = 204
		}		

		available = {
			has_war = yes
			has_country_flag = SOV_scorched_earth
			any_state = {
				is_core_of = BLR
				is_controlled_by = SOV
				NOT = {
					state = 94
					state = 95
					state = 96	
					state = 97
				}
			}
		}

		cost = 0
		fire_only_once = yes
		visible = {
			has_war = yes
			has_country_flag = SOV_scorched_earth
		}

		complete_effect = {
			every_state = {
				limit = {
					is_core_of = BLR
					is_controlled_by = SOV
					NOT = {
						state = 94
						state = 95
						state = 96	
						state = 97
					}
				}
				damage_building = {
					type = infrastructure
					damage = 3
				}
			}
		}

		ai_will_do = {
			factor = 500
		}
	}
	SOV_scorched_earth_ukraine = {

		icon = generic_scorched_earth
		
		highlight_state_targets = {
			state = 91		
		}			

		available = {
			has_war = yes
			has_country_flag = SOV_scorched_earth
			any_state = {
				is_core_of = UKR
				is_controlled_by = SOV
				NOT = {
					state = 197
					state = 203
					state = 202
					state = 193
					state = 259
					state = 226
					state = 196
					state = 200
					state = 221
					state = 225
					state = 227
					state = 228
				}
			}
		}

		cost = 0
		fire_only_once = yes
		visible = {
			has_war = yes
			has_country_flag = SOV_scorched_earth
		}

		complete_effect = {
			every_state = {
				limit = {
					is_core_of = UKR
					is_controlled_by = SOV
					NOT = {
						state = 197
						state = 203
						state = 202
						state = 193
						state = 259
						state = 226
						state = 196
						state = 200
						state = 221
						state = 225
						state = 227
						state = 228
					}
				}
				damage_building = {
					type = infrastructure
					damage = 2
				}
			}
		}

		ai_will_do = {
			factor = 500
		}
	}
	SOV_scorched_earth_ukraine2 = {

		icon = generic_scorched_earth
		
		highlight_state_targets = {
			state = 197
			state = 203
			state = 202
			state = 193
			state = 259
			state = 226
			state = 196
			state = 200
			state = 221
			state = 225
			state = 227
			state = 228
		}				

		available = {
			has_war = yes
			has_country_flag = SOV_scorched_earth
			any_state = {
				is_core_of = UKR
				is_controlled_by = SOV
				NOT = {
					state = 766
					state = 192
					state = 198
					state = 199
					state = 91
					state = 89
					state = 93
					state = 201
				}
			}
		}

		cost = 0
		fire_only_once = yes
		visible = {
			has_war = yes
			has_country_flag = SOV_scorched_earth
		}

		complete_effect = {
			every_state = {
				limit = {
					is_core_of = UKR
					is_controlled_by = SOV
					NOT = {
						state = 766
						state = 192
						state = 198
						state = 199
						state = 91
						state = 89
						state = 93
						state = 201
					}
				}
				damage_building = {
					type = infrastructure
					damage = 3
				}
			}
			if = {
				limit = {
					196 = {is_controlled_by_ROOT_or_ally = yes}
				}
				add_resource = {
	            	type = chromium
	            	amount = -8
	            	state = 196
	            }
				
			}
		}

		ai_will_do = {
			factor = 500
		}
	}
	SOV_scorched_earth_caucasus = {

		icon = generic_scorched_earth
		
		highlight_state_targets = {
			state = 233
		}

		available = {
			has_war = yes
			has_country_flag = SOV_scorched_earth
			OR = {
				420 = { CONTROLLER = { has_war_with = SOV } }
				419 = { CONTROLLER = { has_war_with = SOV } }
				353 = { CONTROLLER = { has_war_with = SOV } }
				354 = { CONTROLLER = { has_war_with = SOV } }
				137 = { CONTROLLER = { has_war_with = SOV } }
				218 = { CONTROLLER = { has_war_with = SOV } }
				238 = { CONTROLLER = { has_war_with = SOV } }
				237 = { CONTROLLER = { has_war_with = SOV } }
				236 = { CONTROLLER = { has_war_with = SOV } }
				231 = { CONTROLLER = { has_war_with = SOV } }#sneaky QA naval invasion check
				233 = { CONTROLLER = { has_war_with = SOV } }
				234 = { CONTROLLER = { has_war_with = SOV } }
			}
		}

		cost = 0
		fire_only_once = yes
		visible = {
			has_war = yes
			has_country_flag = SOV_scorched_earth
		}

		complete_effect = {
			if = {
				limit = {
					229 = { is_controlled_by_ROOT_or_ally = yes }
				}
				229 = {
					damage_building = {
						type = infrastructure
						damage = 2
					}
				}
			}
			if = {
				limit = {
					230 = { is_controlled_by_ROOT_or_ally = yes }
				}
				230 = {
					damage_building = {
						type = infrastructure
						damage = 2
					}
				}
			}
			if = {
				limit = {
					231 = { is_controlled_by_ROOT_or_ally = yes }
				}
				231 = {
					damage_building = {
						type = infrastructure
						damage = 2
					}
				}
			}
			if = {
				limit = {
					232 = { is_controlled_by_ROOT_or_ally = yes }
				}
				232 = {
					damage_building = {
						type = infrastructure
						damage = 2
					}
				}
			}
			if = {
				limit = {
					233 = { is_controlled_by_ROOT_or_ally = yes }
				}
				233 = {
					damage_building = {
						type = infrastructure
						damage = 2
					}
				}
			}
			if = {
				limit = {
					234 = {is_controlled_by_ROOT_or_ally = yes}
				}
				234 = {
					damage_building = {
						type = infrastructure
						damage = 2
					}
				}
			}
			if = {
				limit = {
					235 = {is_controlled_by_ROOT_or_ally = yes}
				}
				235 = {
					damage_building = {
						type = infrastructure
						damage = 2
					}
				}
			}
		}

		ai_will_do = {
			factor = 500
		}
	}
	SOV_scorched_earth_stalingrad = {

		icon = generic_scorched_earth
		
		highlight_state_targets = {
			state = 245
		}		

		available = {
			has_war = yes
			has_country_flag = SOV_scorched_earth
			OR = {
				227 = { CONTROLLER = { has_war_with = SOV } }
				228 = { CONTROLLER = { has_war_with = SOV } }
				218 = { CONTROLLER = { has_war_with = SOV } }
				245 = { CONTROLLER = { has_war_with = SOV } }
				237 = { CONTROLLER = { has_war_with = SOV } }
				236 = { CONTROLLER = { has_war_with = SOV } }
				231 = { CONTROLLER = { has_war_with = SOV } }#sneaky QA naval invasion check
				238 = { CONTROLLER = { has_war_with = SOV } }
				260 = { CONTROLLER = { has_war_with = SOV } }
				239 = { CONTROLLER = { has_war_with = SOV } }
			}
		}

		cost = 0
		fire_only_once = yes
		visible = {
			has_war = yes
			has_country_flag = SOV_scorched_earth
		}

		complete_effect = {
			if = {
				limit = {
					245 = {is_controlled_by_ROOT_or_ally = yes}
				}
				245 = {
					damage_building = {
						type = infrastructure
						damage = 2
					}
				}
			}
			if = {
				limit = {
					218 = {is_controlled_by_ROOT_or_ally = yes}
				}
				218 = {
					damage_building = {
						type = infrastructure
						damage = 2
					}
				}
			}
			if = {
				limit = {
					238 = {is_controlled_by_ROOT_or_ally = yes}
				}
				238 = {
					damage_building = {
						type = infrastructure
						damage = 2
					}
				}
			}
			if = {
				limit = {
					265 = {is_controlled_by_ROOT_or_ally = yes}
				}
				265 = {
					damage_building = {
						type = infrastructure
						damage = 2
					}
				}
			}
		}

		ai_will_do = {
			factor = 500
		}
	}
	SOV_scorched_earth_moscow = {

		icon = generic_scorched_earth
		
		highlight_state_targets = {
			state = 205
		}		

		available = {
			has_war = yes
			has_country_flag = SOV_scorched_earth
			OR = {
				207 = { CONTROLLER = { has_war_with = SOV } }
				210 = { CONTROLLER = { has_war_with = SOV } }
				241 = { CONTROLLER = { has_war_with = SOV } }
				193 = { CONTROLLER = { has_war_with = SOV } }
				225 = { CONTROLLER = { has_war_with = SOV } }
				240 = { CONTROLLER = { has_war_with = SOV } }
			}
		}

		cost = 0
		fire_only_once = yes
		visible = {
			has_war = yes
			has_country_flag = SOV_scorched_earth
		}

		complete_effect = {
			if = {
				limit = {
					220 = {is_controlled_by_ROOT_or_ally = yes}
				}
				220 = {
					damage_building = {
						type = infrastructure
						damage = 3
					}
				}
			}	
			if = {
				limit = {
					222 = {is_controlled_by_ROOT_or_ally = yes}
				}
				222 = {
					damage_building = {
						type = infrastructure
						damage = 3
					}
				}
			}			
			if = {
				limit = {
					224 = {is_controlled_by_ROOT_or_ally = yes}
				}
				224 = {
					damage_building = {
						type = infrastructure
						damage = 3
					}
				}
			}
			if = {
				limit = {
					243 = {is_controlled_by_ROOT_or_ally = yes}
				}
				243 = {
					damage_building = {
						type = infrastructure
						damage = 3
					}
				}
			}
			if = {
				limit = {
					205 = {is_controlled_by_ROOT_or_ally = yes}
				}
				205 = {
					damage_building = {
						type = infrastructure
						damage = 3
					}
				}
			}
			if = {
				limit = {
					242 = {is_controlled_by_ROOT_or_ally = yes}
				}
				242 = {
					damage_building = {
						type = infrastructure
						damage = 3
					}
				}
			}
			if = {
				limit = {
					246 = {is_controlled_by_ROOT_or_ally = yes}
				}
				246 = {
					damage_building = {
						type = infrastructure
						damage = 3
					}
				}
			}		
			if = {
				limit = {
					223 = {is_controlled_by_ROOT_or_ally = yes}
				}
				223 = {
					damage_building = {
						type = infrastructure
						damage = 3
					}
				}
			}				
		}

		ai_will_do = {
			factor = 1
		}
	}
	
	SOV_scorched_earth_caucasus_oil = {

		icon = generic_scorched_earth

		available = {
			has_war = yes
			has_country_flag = SOV_scorched_earth
			OR = {
				420 = { CONTROLLER = { has_war_with = SOV } }
				419 = { CONTROLLER = { has_war_with = SOV } }
				353 = { CONTROLLER = { has_war_with = SOV } }
				354 = { CONTROLLER = { has_war_with = SOV } }
				137 = { CONTROLLER = { has_war_with = SOV } }
				218 = { CONTROLLER = { has_war_with = SOV } }
				238 = { CONTROLLER = { has_war_with = SOV } }
				237 = { CONTROLLER = { has_war_with = SOV } }
				236 = { CONTROLLER = { has_war_with = SOV } }
				231 = { CONTROLLER = { has_war_with = SOV } }#sneaky QA naval invasion check
				233 = { CONTROLLER = { has_war_with = SOV } }
				234 = { CONTROLLER = { has_war_with = SOV } }
				229 = { CONTROLLER = { has_war_with = SOV } }
			}
		}
		
		highlight_state_targets = {
			state = 229
		}
		
		days_remove = 120

		modifier = {
			civilian_factory_use = 2
		}

		cost = 0
		fire_only_once = yes
		visible = {
			has_war = yes
			has_country_flag = SOV_scorched_earth
		}
		
		complete_effect = {
			custom_effect_tooltip = caucasus_oil_fields_burning_tt
			
			229 = {
			set_state_flag = caucasus_oil_burning
				add_resource = {
					type = oil
					amount = -135
				}
			}
		}

		remove_effect = {
			229 = { 
			clr_state_flag = caucasus_oil_burning
			set_state_flag = caucasus_oil_scorched 
			}			
		}

		ai_will_do = {
			factor = 0
			modifier = {
				add = 500
				or = {
					GER = { 
						controls_state = 217
					}
					ROM = { 
						controls_state = 217
					}
				}
			}
		}
	}
		
	#217 "Stalingrad"
	SOV_hold_stalingrad = {

		icon = generic_civil_support

		allowed = {
			original_tag = SOV
		}

		#Fail trigger
		available = {
			NOT = { controls_state = 217 }
		}

		days_mission_timeout = 180

		fire_only_once = yes

		is_good = yes

		activation = {
			has_war = yes
			has_civil_war = no
			217 = {
				is_controlled_by = ROOT
				OR = {
					any_neighbor_state = {
						CONTROLLER = {
							has_war_with = ROOT
						}
						OWNER = { tag = ROOT }
					}
					NOT = { is_fully_controlled_by = ROOT }
				}
			}
		}

		#Success
		timeout_effect = {
			add_stability = 0.05
			add_war_support = 0.05
			217 = { save_event_target_as = state }			
			country_event = wtt_soviet_hold_city.1
		}
		#Fail
		complete_effect = {
			217 = { save_event_target_as = state }			
			country_event = wtt_soviet_hold_city.2
		}
	}
	
	#195 "Leningrad"
	SOV_hold_leningrad = {

		icon = generic_civil_support

		allowed = {
			original_tag = SOV
		}

		#Fail trigger
		available = {
			NOT = { controls_state = 195 }
		}

		days_mission_timeout = 180

		fire_only_once = yes

		is_good = yes

		activation = {
			has_war = yes
			has_civil_war = no
			195 = {
				is_controlled_by = ROOT
				OR = {
					any_neighbor_state = {
						CONTROLLER = {
							has_war_with = ROOT
						}
						OWNER = { tag = ROOT }
					}
					NOT = { is_fully_controlled_by = ROOT }
				}
			}
		}

		#Success
		timeout_effect = {
			add_stability = 0.05
			add_war_support = 0.05
			195 = { save_event_target_as = state }
			country_event = wtt_soviet_hold_city.3
		}
		#Fail
		complete_effect = {
			195 = { save_event_target_as = state }
			country_event = wtt_soviet_hold_city.4
		}
	}

	#219 "Moscow"
	SOV_hold_moscow = {

		icon = generic_civil_support

		allowed = {
			original_tag = SOV
		}

		#Fail trigger
		available = {
			NOT = { controls_state = 219 }
		}

		days_mission_timeout = 180

		fire_only_once = yes

		is_good = yes

		activation = {
			has_war = yes
			has_civil_war = no
			219 = {
				is_controlled_by = ROOT
				OR = {
					any_neighbor_state = {
						CONTROLLER = {
							has_war_with = ROOT
						}
						OWNER = { tag = ROOT }
					}
					NOT = { is_fully_controlled_by = ROOT }
				}
			}
		}

		#Success
		timeout_effect = {
			add_stability = 0.05
			add_war_support = 0.05
			219 = { save_event_target_as = state }
			country_event = wtt_soviet_hold_city.5
		}
		#Fail
		complete_effect = {
			219 = { save_event_target_as = state }
			country_event = wtt_soviet_hold_city.6
		}
	}
}

SOV_industry_relocation = {

	SOV_relocate_industry_from_moscow = {

		icon = generic_construction

		highlight_state_targets = {
			state = 219
		}	

		available = {
			219 = { #Moscow
				is_owned_and_controlled_by = SOV
				arms_factory > 6
				industrial_complex > 2
			} 
			573 = { is_owned_and_controlled_by = SOV } #Zlatoust
			582 = { is_owned_and_controlled_by = SOV } #Magnitogorsk
		}

		fire_only_once = yes

		cost = 25
		days_remove = 15

		modifier = {
			
		}

		ai_will_do = {
			factor = 1
			modifier = {
				factor = 10000 # oh shit they are getting close!
				OR = {
					AND = {
						owns_state = 246
						NOT = { controls_state = 246 }
					}
					AND = {
						owns_state = 242
						NOT = { controls_state = 242 }
					}
					AND = {
						owns_state = 205
						NOT = { controls_state = 205 }
					}
					AND = {
						owns_state = 223
						NOT = { controls_state = 223 }
					}
					AND = {
						owns_state = 243
						NOT = { controls_state = 243 }
					}
					AND = {
						owns_state = 224
						NOT = { controls_state = 224 }
					}
					AND = {
						owns_state = 222
						NOT = { controls_state = 224 }
					}
				}
			}
		}

		visible = {
			has_war = yes
		}

		remove_effect = {
			if = {
				limit = {
					controls_state = 219
				}
				219 = { #Moscow
					remove_building = {
						type = arms_factory
						level = 7
					}
					remove_building = {
						type = industrial_complex
						level = 3
					}
				}
				573 = { #Zlatoust
					add_extra_state_shared_building_slots = 4
					add_building_construction = {
						type = arms_factory
						level = 4
						instant_build = yes
					}
					add_building_construction = {
						type = industrial_complex
						level = 1
						instant_build = yes
					}
	
					hidden_effect = {
						damage_building = { type = arms_factory damage = 0.3 }
						damage_building = { type = industrial_complex damage = 0.1 }
					}
				}
				582 = { #Magnitogorsk
					add_extra_state_shared_building_slots = 4
					add_building_construction = {
						type = arms_factory
						level = 3
						instant_build = yes
					}
					add_building_construction = {
						type = industrial_complex
						level = 1
						instant_build = yes
					}
				
					hidden_effect = {
						damage_building = { type = arms_factory damage = 0.3 }
						damage_building = { type = industrial_complex damage = 0.1 }
					}
				}
				custom_effect_tooltip = relocate_industry_repair
			}
			custom_effect_tooltip = SOV_relocate_industry_from_moscow_tt
		}
	}
	
	SOV_relocate_industry_from_rzhev = {

		icon = generic_construction

		highlight_state_targets = {
			state = 246
		}	

		available = {
			653 = { is_owned_and_controlled_by = SOV } #Sverdlovsk
			572 = { is_owned_and_controlled_by = SOV } #Chelyabinsk
		}

		fire_only_once = yes

		cost = 25
		days_remove = 50

		modifier = {
			
		}

		ai_will_do = {
			factor = 1
			modifier = {
				factor = 10000 # oh shit they are getting close!
				OR = {
					AND = {
						owns_state = 210
						NOT = { controls_state = 210 }
					}
					AND = {
						owns_state = 242
						NOT = { controls_state = 242 }
					}
					AND = {
						owns_state = 205
						NOT = { controls_state = 205 }
					}
					AND = {
						owns_state = 223
						NOT = { controls_state = 223 }
					}
					AND = {
						owns_state = 243
						NOT = { controls_state = 243 }
					}
					AND = {
						owns_state = 224
						NOT = { controls_state = 224 }
					}
					AND = {
						owns_state = 222
						NOT = { controls_state = 224 }
					}
				}
			}
		}

		visible = {
			has_war = yes
			246 = { #rzhev
				is_owned_and_controlled_by = SOV
				arms_factory > 5
				industrial_complex > 5
			} 
		}

		remove_effect = {
			if = {
				limit = {
					controls_state = 246
				}
				246 = { #Rzhev
					remove_building = {
						type = arms_factory
						level = 6
					}
					remove_building = {
						type = industrial_complex
						level = 6
					}
				}
				653 = { 
					add_extra_state_shared_building_slots = 6
					add_building_construction = {
						type = arms_factory
						level = 3
						instant_build = yes
					}
					add_building_construction = {
						type = industrial_complex
						level = 3
						instant_build = yes
					}
	
					hidden_effect = {
						damage_building = { type = arms_factory damage = 0.3 }
						damage_building = { type = industrial_complex damage = 0.1 }
					}
				}
				572 = { #Magnitogorsk
					add_extra_state_shared_building_slots = 6
					add_building_construction = {
						type = arms_factory
						level = 3
						instant_build = yes
					}
					add_building_construction = {
						type = industrial_complex
						level = 3
						instant_build = yes
					}
				
					hidden_effect = {
						damage_building = { type = arms_factory damage = 0.3 }
						damage_building = { type = industrial_complex damage = 0.1 }
					}
				}
				custom_effect_tooltip = relocate_industry_repair
			}
			custom_effect_tooltip = SOV_relocate_industry_from_rzhev_tt
		}
	}
	
	SOV_relocate_industry_from_riga = {

		icon = generic_construction

		highlight_state_targets = {
			state = 12
		}	

		available = {
			580 = { is_owned_and_controlled_by = SOV } #Tobolsk
			236 = { is_owned_and_controlled_by = SOV } #Astrakhan
		}

		fire_only_once = yes

		cost = 25
		days_remove = 50

		modifier = {
			
		}

		ai_will_do = {
			factor = 1
			modifier = {
				factor = 10000 # oh shit they are getting close!
				OR = {
					AND = {
						owns_state = 190
						NOT = { controls_state = 190 }
					}
					AND = {
						owns_state = 11
						NOT = { controls_state = 11 }
					}
					AND = {
						owns_state = 13
						NOT = { controls_state = 13 }
					}
					AND = {
						owns_state = 191
						NOT = { controls_state = 191 }
					}
				}
			}
		}

		visible = {
			has_war = yes
			12 = { #riga
				is_owned_and_controlled_by = SOV
				arms_factory > 5
				industrial_complex > 5
			} 
		}

		remove_effect = {
			if = {
				limit = {
					controls_state = 12
				}
				12 = { #Riga
					remove_building = {
						type = arms_factory
						level = 6
					}
					remove_building = {
						type = industrial_complex
						level = 6
					}
				}
				580 = { 
					add_extra_state_shared_building_slots = 6
					add_building_construction = {
						type = arms_factory
						level = 3
						instant_build = yes
					}
					add_building_construction = {
						type = industrial_complex
						level = 3
						instant_build = yes
					}
	
					hidden_effect = {
						damage_building = { type = arms_factory damage = 0.3 }
						damage_building = { type = industrial_complex damage = 0.1 }
					}
				}
				236 = {
					add_extra_state_shared_building_slots = 6
					add_building_construction = {
						type = arms_factory
						level = 3
						instant_build = yes
					}
					add_building_construction = {
						type = industrial_complex
						level = 3
						instant_build = yes
					}
				
					hidden_effect = {
						damage_building = { type = arms_factory damage = 0.3 }
						damage_building = { type = industrial_complex damage = 0.1 }
					}
				}
				custom_effect_tooltip = relocate_industry_repair
			}
			custom_effect_tooltip = SOV_relocate_industry_from_riga_tt
		}
	}
	
	SOV_relocate_industry_from_ukraine = {

		icon = generic_construction

		highlight_state_targets = {
			state = 202
			state = 203
			state = 197
			state = 226
			state = 259
			state = 193
			state = 200
			state = 196
			state = 225
			state = 221
			state = 227
			state = 228
		}	

		available = {
			582 = { is_owned_and_controlled_by = SOV } 
			572 = { is_owned_and_controlled_by = SOV } 
			583 = { is_owned_and_controlled_by = SOV } 
		}

		fire_only_once = yes

		cost = 100
		days_remove = 150

		modifier = {
			
		}

		ai_will_do = {
			factor = 1
			modifier = {
				factor = 10000 # oh shit they are getting close!
				OR = {
					AND = {
						owns_state = 202
						NOT = { controls_state = 202 }
					}
					AND = {
						owns_state = 192
						NOT = { controls_state = 192 }
					}
					AND = {
						owns_state = 203
						NOT = { controls_state = 203 }
					}
				}
			}
		}

		visible = {
			has_war = yes
			203 = { #cherkasy
				is_owned_and_controlled_by = SOV
				arms_factory > 0
				industrial_complex > 1
			} 
			226 = { #dnipropetrovsk
				is_owned_and_controlled_by = SOV
				industrial_complex > 1
			}
			221 = { #kharkov
				is_owned_and_controlled_by = SOV
				arms_factory > 4
			}
			227 = { #stalino
				is_owned_and_controlled_by = SOV
				arms_factory > 2
			}
		}

		remove_effect = {
			if = {
				limit = {
					controls_state = 203
				}
				203 = { 
					remove_building = {
						type = arms_factory
						level = 1
					}
					remove_building = {
						type = industrial_complex
						level = 2
					}
				}
				582 = { 
					add_extra_state_shared_building_slots = 3
					add_building_construction = {
						type = arms_factory
						level = 1
						instant_build = yes
					}
					add_building_construction = {
						type = industrial_complex
						level = 2
						instant_build = yes
					}
	
					hidden_effect = {
						damage_building = { type = arms_factory damage = 0.3 }
						damage_building = { type = industrial_complex damage = 0.1 }
					}
				}
				custom_effect_tooltip = relocate_industry_repair
			}
			if = {
				limit = {
					controls_state = 226
				}
				226 = { 
					remove_building = {
						type = industrial_complex
						level = 2
					}
				}
				572 = { 
					add_extra_state_shared_building_slots = 2
					add_building_construction = {
						type = industrial_complex
						level = 2
						instant_build = yes
					}
	
					hidden_effect = {
						damage_building = { type = arms_factory damage = 0.3 }
						damage_building = { type = industrial_complex damage = 0.1 }
					}
				}
				custom_effect_tooltip = relocate_industry_repair
			}
			if = {
				limit = {
					controls_state = 221
				}
				221 = { 
					remove_building = {
						type = arms_factory
						level = 5
					}
				}
				572 = { 
					add_extra_state_shared_building_slots = 5
					add_building_construction = {
						type = arms_factory
						level = 5
						instant_build = yes
					}
	
					hidden_effect = {
						damage_building = { type = arms_factory damage = 0.3 }
						damage_building = { type = industrial_complex damage = 0.1 }
					}
				}
				custom_effect_tooltip = relocate_industry_repair
			}
			if = {
				limit = {
					controls_state = 227
				}
				227 = { 
					remove_building = {
						type = arms_factory
						level = 3
					}
				}
				583 = { 
					add_extra_state_shared_building_slots = 3
					add_building_construction = {
						type = arms_factory
						level = 3
						instant_build = yes
					}
	
					hidden_effect = {
						damage_building = { type = arms_factory damage = 0.3 }
						damage_building = { type = industrial_complex damage = 0.1 }
					}
				}
				custom_effect_tooltip = relocate_industry_repair
			}
			custom_effect_tooltip = SOV_relocate_industry_from_ukraine_tt
		}
	}

	SOV_relocate_industry_from_leningrad = {

		icon = generic_construction

		highlight_state_targets = {
			state = 195
		}

		available = {
			573 = { is_owned_and_controlled_by = SOV } #Zlatoust
			582 = { is_owned_and_controlled_by = SOV } #Magnitogorsk
		}

		fire_only_once = yes

		cost = 25
		days_remove = 15

		modifier = {
			
		}

		ai_will_do = {
			factor = 1
			modifier = {
				factor = 10000 # oh shit they are getting close!
				OR = {
					AND = {
						owns_state = 208
						NOT = { controls_state = 208 }
					}
					AND = {
						owns_state = 209
						NOT = { controls_state = 209 }
					}
					AND = {
						owns_state = 244
						NOT = { controls_state = 244 }
					}
					AND = {
						owns_state = 263
						NOT = { controls_state = 263 }
					}
					AND = {
						owns_state = 191
						NOT = { controls_state = 191 }
					}
					AND = {
						owns_state = 146
						NOT = { controls_state = 146 }
					}
				}
			}
		}

		visible = {
			has_war = yes
			195 = { #Leningrad
				is_owned_and_controlled_by = SOV
				arms_factory > 8
				industrial_complex > 1
			}
		}

		remove_effect = {
			if = {
				limit = {
					controls_state = 195
				}
				195 = { #Leningrad
					remove_building = {
						type = arms_factory
						level = 9
					}
					remove_building = {
						type = industrial_complex
						level = 2
					}
				}
	
				573 = { #Zlatoust
					add_extra_state_shared_building_slots = 4
					add_building_construction = {
						type = arms_factory
						level = 4
						instant_build = yes
					}
	
					hidden_effect = {			
						damage_building = { type = arms_factory damage = 0.3 }
					}
				}
				582 = { #Magnitogorsk
					add_extra_state_shared_building_slots = 6
					add_building_construction = {
						type = arms_factory
						level = 4
						instant_build = yes
					}
					add_building_construction = {
						type = industrial_complex
						level = 2
						instant_build = yes
					}
	
					hidden_effect = {			
						damage_building = { type = arms_factory damage = 0.2 }
						damage_building = { type = industrial_complex damage = 0.1 }
					}
				}
				custom_effect_tooltip = relocate_industry_repair
			}
			custom_effect_tooltip = SOV_relocate_industry_from_leningrad_tt
		}
	}

	SOV_relocate_industry_from_smolensk = {

		icon = generic_construction

		highlight_state_targets = {
			state = 242
		}

		available = {
			573 = { is_owned_and_controlled_by = SOV } #Zlatoust
			582 = { is_owned_and_controlled_by = SOV } #Magnitogorsk
		}

		fire_only_once = yes

		cost = 25
		days_remove = 15

		modifier = {
			
		}

		ai_will_do = {
			factor = 1
			modifier = {
				factor = 10000 # oh shit they are getting close!
				OR = {
					AND = {
						owns_state = 210
						NOT = { controls_state = 210 }
					}
					AND = {
						owns_state = 207
						NOT = { controls_state = 207 }
					}
					AND = {
						owns_state = 206
						NOT = { controls_state = 206 }
					}
					AND = {
						owns_state = 241
						NOT = { controls_state = 241 }
					}
					AND = {
						owns_state = 243
						NOT = { controls_state = 243 }
					}
					AND = {
						owns_state = 205
						NOT = { controls_state = 205 }
					}
					AND = {
						owns_state = 246
						NOT = { controls_state = 246 }
					}
				}
			}
		}

		visible = {
			has_war = yes
			242 = { #Smolensk
				is_owned_and_controlled_by = SOV
				industrial_complex > 2
			}
			207 = { #Smolensk
				is_owned_and_controlled_by = SOV
				industrial_complex > 0
			}
		}

		remove_effect = {
			if = {
				limit = {
					controls_state = 242
				}
				242 = { #Smolensk
					remove_building = {
						type = industrial_complex
						level = 3
					}
				}
				573 = { #Zlatoust
					add_extra_state_shared_building_slots = 1				
					add_building_construction = {
						type = industrial_complex
						level = 1
						instant_build = yes
					}
	
					hidden_effect = {			
						damage_building = { type = industrial_complex damage = 0.1 }
					}
				}
				582 = { #Magnitogorsk
					add_extra_state_shared_building_slots = 1
					add_building_construction = {
						type = industrial_complex
						level = 2
						instant_build = yes
					}
				
					hidden_effect = {
						damage_building = { type = industrial_complex damage = 0.1 }
					}
				}
				custom_effect_tooltip = relocate_industry_repair
			}
			if = {
				limit = {
					controls_state = 207
				}
				207 = { #Vitebsk
					remove_building = {
						type = industrial_complex
						level = 1
					}
				}
				573 = { #Zlatoust
					add_extra_state_shared_building_slots = 1				
					add_building_construction = {
						type = industrial_complex
						level = 1
						instant_build = yes
					}
				}
			}
			custom_effect_tooltip = SOV_relocate_industry_from_smolensk_tt
		}
	}
	SOV_relocate_industry_from_keiv = {

		icon = generic_construction

		highlight_state_targets = {
			state = 202
		}

		available = {
			402 = { is_owned_and_controlled_by = SOV } #Akhtubinsk
		}

		fire_only_once = yes

		cost = 25
		days_remove = 15

		modifier = {
			
		}

		ai_will_do = {
			factor = 1
			modifier = {
				factor = 10000 # oh shit they are getting close!
				OR = {
					AND = {
						owns_state = 210
						NOT = { controls_state = 210 }
					}
					AND = {
						owns_state = 207
						NOT = { controls_state = 207 }
					}
					AND = {
						owns_state = 206
						NOT = { controls_state = 206 }
					}
					AND = {
						owns_state = 241
						NOT = { controls_state = 241 }
					}
					AND = {
						owns_state = 243
						NOT = { controls_state = 243 }
					}
					AND = {
						owns_state = 205
						NOT = { controls_state = 205 }
					}
					AND = {
						owns_state = 246
						NOT = { controls_state = 246 }
					}
				}
			}
		}

		visible = {
			has_war = yes
			202 = { #Keiv
				is_owned_and_controlled_by = SOV
				industrial_complex > 2
				arms_factory > 3
			}
		}

		remove_effect = {
			if = {
				limit = {
					controls_state = 202
				}
				202 = { #Keiv
					remove_building = {
						type = industrial_complex
						level = 3
					}
					remove_building = {
						type = arms_factory
						level = 4
					}
				}
				402 = { #Akhtubinsk
					add_extra_state_shared_building_slots = 6				
					add_building_construction = {
						type = industrial_complex
						level = 3
						instant_build = yes
					}
					add_building_construction = {
						type = arms_factory
						level = 4
						instant_build = yes
					}
	
					hidden_effect = {			
						damage_building = { type = industrial_complex damage = 0.4 }
					}
				}
				custom_effect_tooltip = relocate_industry_repair
			}
		}
	}
	
	SOV_relocate_industry_from_minsk = {

		icon = generic_construction

		highlight_state_targets = {
			state = 206
		}

		available = {
			580 = { is_owned_and_controlled_by = SOV } #Tobolsk
		}

		fire_only_once = yes

		cost = 25
		days_remove = 15

		modifier = {
			
		}

		ai_will_do = {
			factor = 1
			modifier = {
				factor = 10000 # oh shit they are getting close!
				OR = {
					AND = {
						owns_state = 210
						NOT = { controls_state = 210 }
					}
					AND = {
						owns_state = 207
						NOT = { controls_state = 207 }
					}
					AND = {
						owns_state = 206
						NOT = { controls_state = 206 }
					}
					AND = {
						owns_state = 241
						NOT = { controls_state = 241 }
					}
					AND = {
						owns_state = 243
						NOT = { controls_state = 243 }
					}
					AND = {
						owns_state = 205
						NOT = { controls_state = 205 }
					}
					AND = {
						owns_state = 246
						NOT = { controls_state = 246 }
					}
				}
			}
		}

		visible = {
			has_war = yes
			206 = { #Minsk
				is_owned_and_controlled_by = SOV
				industrial_complex > 1
				arms_factory > 2
			}
		}

		remove_effect = {
			if = {
				limit = {
					controls_state = 206
				}
				206 = { #Minsk
					remove_building = {
						type = industrial_complex
						level = 2
					}
					remove_building = {
						type = arms_factory
						level = 3
					}
				}
				580 = { #Tobolsk
					add_extra_state_shared_building_slots = 5
					add_building_construction = {
						type = industrial_complex
						level = 2
						instant_build = yes
					}
					add_building_construction = {
						type = arms_factory
						level = 3
						instant_build = yes
					}
	
					hidden_effect = {			
						damage_building = { type = industrial_complex damage = 0.4 }
					}
				}
				custom_effect_tooltip = relocate_industry_repair
			}
		}
	}
	move_leningrad_aluminium_plant = { #195

		icon = aluminium
		
		highlight_state_targets = {
			state = 195
		}

		allowed = {
			#Everyone
		}

		available = {
			has_full_control_of_state = 195
			has_full_control_of_state = 569
			
		}

		visible = {
			controls_state = 195
			controls_state = 569
			195 = { has_state_flag = leningrad_aluminium_developed }
			has_war = yes
		}

		fire_only_once = yes

		cost = 25
		days_remove = 15

		modifier = {
			
		}

		ai_will_do = {
			factor = 1
			modifier = {
				factor = 10000 # oh shit they are getting close!
				OR = {
					AND = {
						owns_state = 208
						NOT = { controls_state = 208 }
					}
					AND = {
						owns_state = 209
						NOT = { controls_state = 209 }
					}
					AND = {
						owns_state = 244
						NOT = { controls_state = 244 }
					}
					AND = {
						owns_state = 263
						NOT = { controls_state = 263 }
					}
					AND = {
						owns_state = 191
						NOT = { controls_state = 191 }
					}
					AND = {
						owns_state = 146
						NOT = { controls_state = 146 }
					}
				}
			}
		}

		remove_effect = {
			if = {
				limit = {
					controls_state = 195
				}
				195 = {
					add_resource = {
						type = aluminium
						amount = -12
					}				
				}
				569 = {
					add_resource = {
						type = aluminium
						amount = 12
					}
				}
			}
			custom_effect_tooltip = SOV_relocate_industry_from_leningrad_tt
		}
	}
}


operations = {

	SOV_armistice = {
		icon = decision_generic_SOV
		allowed = {
			original_tag = SOV
		}
		available = {
			surrender_progress > 0.9
			has_war_with = GER
			has_war_with = ROM
			has_war_with = FIN
		}
		
		cost = 0
		
		fire_only_once = yes
		
		ai_will_do = {
			factor = 500
			modifier = {
				factor = 0
				surrender_progress < 0.97
			}
		}
		
		visible = {
			has_war_with = GER
		}
		
		complete_effect = {
			country_event = {
				id = soviet.391
			}
		}
		
	}

	SOV_waronpoland = {
		icon = decision_generic_SOV
		allowed = {
			original_tag = SOV
		}
		highlight_state_targets = {
			state = 94
		}
		
		available = {
	    	tag = SOV
			NOT = { has_war_with = GER }
			POL = { has_capitulated = no }
			or = {
				and = {
					has_global_flag = sov_yes_pact
					is_puppet = no
					GER = { has_war_with = POL }
					POL = { surrender_progress > 0.1 
					OR = { 
						is_in_faction_with = ENG
						is_in_faction_with = FRA
					}
					}
					ENG = { has_war_with = GER }
				}
				and = {
					SOV = { has_completed_focus = SOV_claims_on_poland }
					has_global_flag = GER_acceptdanzig
				}
			}
		}
		
		cost = 0
		
		fire_only_once = yes
		
		ai_will_do = {
			factor = 500
				modifier = {
					factor = 0
					and = {
						GER = { is_ai = yes }
						POL = { controls_state = 10 }
					}
					date < 1939.9.13
				}
		}
		
		visible = {
			date > 1939.1.1
			tag = SOV
		}
		
		complete_effect = {	
		        effect_tooltip = {
				add_war_support = 0.05
				}
				country_event = {
					id = poland.20
					days = 1
				}		
		}		
	}
	
	SOV_trotsky = {
		icon = decision_generic_SOV
		allowed = {
			original_tag = SOV
		}
		available = {
	    	tag = SOV
			has_completed_focus = SOV_great_purge 
			has_completed_focus = SOV_kgb
			NOT = { MEX = { is_in_faction_with = USA } }
		}
		
		cost = 0
		
		fire_only_once = yes
		
		ai_will_do = {
			factor = 100
		}
		
		visible = {
	    	tag = SOV
			OR = { has_completed_focus = SOV_kgb has_completed_focus = SOV_great_purge }
		}
		
		complete_effect = {	
		    hidden_effect = {
				news_event = {
        			id = news.37
	    		days = 1
		}
			}
			country_event = {
				id = soviet.53
				days = 1
			}
			effect_tooltip = { remove_ideas = trotskyite_plot_purged }
		}		
	}
	
}

	political_actions = {

	demand_tribute_from_new_communist_china = {

		icon = generic_civil_support

		allowed = {
			tag = SOV
		}

		icon = generic_political_actions

		available = {
			
		}

		ai_will_do = {
			base = 0
			modifier = {
				add = 150
					#Has somewhat won against CHI and JAP
				count_triggers = {
					amount = 10
					595 = { is_controlled_by = FROM }
					596 = { is_controlled_by = FROM }
					597 = { is_controlled_by = FROM }
					598 = { is_controlled_by = FROM }
					600 = { is_controlled_by = FROM }
					601 = { is_controlled_by = FROM }
					602 = { is_controlled_by = FROM }
					603 = { is_controlled_by = FROM }
					605 = { is_controlled_by = FROM }
					606 = { is_controlled_by = FROM }
					607 = { is_controlled_by = FROM }
					608 = { is_controlled_by = FROM }
					613 = { is_controlled_by = FROM }
					614 = { is_controlled_by = FROM }
					620 = { is_controlled_by = FROM }				
				}
			}

		}

		cost = 10

		visible = {
			has_government = communism
			FROM = {
				tag = event_target:WTT_communist_china
				has_country_flag = WTT_support_from_soviet
				NOT = { has_war_with = ROOT }
				NOT = { is_subject_of = ROOT }
				NOT = { has_idea = PRC_soviet_tribute_6 }
			}
		}

		target_trigger = {
			FROM = { has_country_flag = WTT_support_from_soviet }
		}

		fire_only_once = no

		days_re_enable = 180

		complete_effect = {
			FROM = {
				country_event = { id = wtt_warlord_vs_prc.21 }
				custom_effect_tooltip = if_they_accept
				effect_tooltip = {
					PRC_soviet_tribute_level_up = yes	
				}
			}
		}
	}

	demand_full_integration = {

		icon = generic_civil_support

		allowed = {
			tag = SOV			
		}

		icon = generic_political_actions

		available = {
			FROM = { has_soviet_tribute = yes }
		}

		cost = WTT_communist_china_integration_cost?300

		visible = {
			has_government = communism
			FROM = { has_country_flag = WTT_support_from_soviet }
		}

		target_trigger = {
			FROM = { has_country_flag = WTT_support_from_soviet }
		}

		ai_will_do = {
			base = 0
			modifier = {
				add = 0
				#Has won against CHI and JAP
				595 = { is_controlled_by = FROM }
				596 = { is_controlled_by = FROM }
				597 = { is_controlled_by = FROM }
				598 = { is_controlled_by = FROM }
				600 = { is_controlled_by = FROM }
				601 = { is_controlled_by = FROM }
				602 = { is_controlled_by = FROM }
				603 = { is_controlled_by = FROM }
				605 = { is_controlled_by = FROM }
				606 = { is_controlled_by = FROM }
				607 = { is_controlled_by = FROM }
				608 = { is_controlled_by = FROM }
				613 = { is_controlled_by = FROM }
				614 = { is_controlled_by = FROM }
				620 = { is_controlled_by = FROM }
			}
			modifier = {
				add = 0
				FROM = {
					check_variable = { WTT_communist_china_integration_cost < 200 }
				}
			}
			modifier = {
				add = 0
				FROM = {
					check_variable = { WTT_communist_china_integration_cost < 150 }
				}
			}
			modifier = {
				add = 0
				FROM = {
					check_variable = { WTT_communist_china_integration_cost < 100 }
				}
			}
		}

		fire_only_once = yes

		complete_effect = {
			FROM = { country_event = { id = wtt_warlord_vs_prc.31 } }
		}
	}	
	
	#SOVIET MISSION TO OCCUPY TURKEY
	SOV_set_up_puppet_state_in_turkey = {

		icon = generic_civil_support

		allowed = {
			has_dlc = "Battle for the Bosporus"
			tag = SOV
		}

		available = {
		    has_global_flag = GRE_turkey_surrenders
		}

		target_trigger = {
			FROM = {
				original_tag = TUR
			}
		}

		cost = 50

		fire_only_once = yes

		days_remove = 90

		visible = {
			has_government = communism
			has_global_flag = GRE_turkey_surrenders
			FROM = {
				NOT = { 
					is_subject_of = SOV 
				}
				NOT = { 
					is_subject_of = GRE
				}
			}
		}

		cancel_if_not_visible = yes

		remove_effect = {
		}

		complete_effect = {
			TUR = {
				country_event = { id = bftb_greece.34 }
			}
			hidden_effect = {
				clr_global_flag = GRE_turkey_surrenders
			}
		}

		ai_will_do = {
			factor = 0
		}
	}

}

SOV_global_revolution = {

	SOV_guns_for_china_against_china = {

		icon = generic_prepare_civil_war

		allowed = {
			original_tag = SOV
		}

		available = {
			has_equipment = { infantry_equipment > 4999 }
			CCP = {
				has_war_with = CHI
			}
		}

		visible = {
			CCP = {
				has_war_with = CHI
			}
		}

		cost = 15
		ai_will_do = {
			factor = 25

			modifier = {
				factor = 0.5
				has_war_support < 0.6
			}

			modifier = {
				factor = 2
				has_war_with = CHI
			}
		}

		fire_only_once = no	

		days_re_enable = 180

		complete_effect = {
			ROOT = {
				send_equipment = {
					target = CCP
					type = infantry_equipment
					amount = 5000
					old_prioritised = yes
				}
			}
		}
	}

	SOV_support_china_with_factories_against_china = {

		icon = generic_industry

		allowed = {
			original_tag = SOV
		}

		available = {
			CCP = { 
				has_war_with = CHI
			}
			num_of_civilian_factories_available_for_projects > 9
		}

		visible = {
			CCP = { 
				has_war_with = CHI
			}
		}

		cost = 5
		ai_will_do = {
			factor = 50

			modifier = {
				factor = 0.5
				has_war_support > 0.6
			}

			modifier = {
				factor = 2
				has_war_with = CHI
			}
		}

		fire_only_once = no

		modifier = {
			civilian_factory_use = 10			
		}

		days_remove = 180

		complete_effect = {
			CCP = {
				add_offsite_building = { type = arms_factory level = 10 }
			}
		}

		remove_effect = {		
			if = { 
			    limit = { 
				   CCP = { 
				        NOT = { has_country_flag = SOV_support_china_with_factories_against_china } 
				    } 
				}
		    	CCP = { 
				    add_war_support = 0.05  # todo:event for CCP
					set_country_flag = SOV_support_china_with_factories_against_china
				}
			}

			CCP = {
				add_offsite_building = { type = arms_factory level = -10 } # bug? move up into brackets?
			}
		}
	}

	SOV_guns_for_china = {

		icon = generic_prepare_civil_war

		allowed = {
			original_tag = SOV
		}

		available = {
			has_equipment = { infantry_equipment > 999 }
			CCP = {
				has_war_with = JAP
			}
		}

		visible = {
			CCP = {
				has_war_with = JAP
			}
		}

		cost = 25
		ai_will_do = {
			factor = 25

			modifier = {
				factor = 0.5
				has_war_support < 0.6
			}

			modifier = {
				factor = 2
				has_war_with = JAP
			}
		}

		fire_only_once = no	

		days_re_enable = 180

		complete_effect = {
			ROOT = {
				send_equipment = {
					target = CCP
					type = infantry_equipment
					amount = 1000
					old_prioritised = yes
				}
			}
		}
	}

	SOV_support_china_with_factories = {

		icon = generic_industry

		allowed = {
			original_tag = SOV
		}

		available = {
				CCP = { 
					has_war_with = JAP
				}
			num_of_civilian_factories_available_for_projects > 4
		}

		visible = {
				CCP = { 
					has_war_with = JAP
				}
		}

		cost = 25
		ai_will_do = {
			factor = 50

			modifier = {
				factor = 0.5
				has_war_support > 0.6
			}

			modifier = {
				factor = 2
				has_war_with = JAP
			}
		}

		fire_only_once = no

		modifier = {
			civilian_factory_use = 5			
		}

		days_remove = 180

		complete_effect = {
			CCP = {
				add_offsite_building = { type = arms_factory level = 3 }
			}
		}

		remove_effect = {
				CCP = {
					add_offsite_building = { type = arms_factory level = -3 }
				}			
		}
	}
	
	SOV_guns_for_spain = {

		icon = generic_prepare_civil_war

		allowed = {
			original_tag = SOV
		}

		available = {
			has_equipment = { infantry_equipment > 1999 }

            if = {
				limit = {
					has_dlc = "La Resistance"
				}
				SPD = {
					exists = yes
					has_civil_war = yes	
                }
            }				
            if = {
				limit = {
					NOT = { has_dlc = "La Resistance" }
				}
				always = no	
            }			
		}

		visible = {
		    has_dlc = "La Resistance"	
            SPR_scw_in_progress = yes
		}

		cost = 5
		ai_will_do = {
			factor = 50
		}
		
		fire_only_once = no	

		days_re_enable = 180

		complete_effect = {	


            send_equipment = {
			target = SPD 
			type = infantry_equipment
			amount = 2000
			old_prioritised = yes
			}
				
		}
	}

	SOV_support_spain_with_factories = {

		icon = generic_industry

		allowed = {
			original_tag = SOV
		}

		available = {
			has_completed_focus = SOV_support_spain
			num_of_civilian_factories_available_for_projects > 3	
			if = {
				limit = {
					has_dlc = "La Resistance"
				}
				SPD = {
					exists = yes
					has_civil_war = yes	
                }
            }				
            if = {
				limit = {
					NOT = { has_dlc = "La Resistance" }
				}
				always = no	
            }
		}

		visible = {
		    has_dlc = "La Resistance"
			SPR_scw_in_progress = yes
		}
		ai_will_do = {
			factor = 50
		}
		cost = 20

		fire_only_once = no

		modifier = {
			civilian_factory_use = 4			
		}

		days_remove = 180

		complete_effect = {
			SPD = {
				add_offsite_building = { type = arms_factory level = 5 }
			}
		}

		remove_effect = {
		    if = { 
			    limit = { SPD = { NOT = { has_country_flag = SOV_support_spain_with_factories } } }
		    	SPD = { 
				    add_war_support = 0.05 
					set_country_flag = SOV_support_spain_with_factories 
				}
			}
			
			SPD = {			    
				add_offsite_building = { type = arms_factory level = -5 }
			}
		}
	}
}

SOV_tanks_corps = { 
	SOV_Tank_Corps_focus = {
		available = {
			original_tag = SOV
		}
		allowed = {
			original_tag = SOV
		}
		cost = 5
		icon = generic_political_actions
		fire_only_once = yes

		ai_will_do = {
			factor = 15
		}	
		complete_effect = {
			SOV = {
				country_event = SOV_tank_event.1
			}
		}

	}
	SOV_Tank_Corps_wave_two_focus = {
		available = {
			date > 1941.12.1
			custom_trigger_tooltip = { tooltip = barba_7
		    	check_variable = {
			    	var = global.ostfront_year_4
			    	value = 7
			    	compare = greater_than_or_equals
		    	}
			}
		}
		allowed = {
			original_tag = SOV
		}

		cost = 10
		icon = generic_political_actions

		ai_will_do = {
			factor = 8
		}	
		fire_only_once = yes
		complete_effect = {
			SOV = {
				country_event = SOV_tank_event.2
			}
		}

	}
	SOV_Tank_Corps_wave_three_focus = {
		available = {
			date > 1942.7.20
			custom_trigger_tooltip = { tooltip = barba_11
		    	check_variable = {
			    	var = global.ostfront_year_4
			    	value = 11
			    	compare = greater_than_or_equals
		    	}
			}
			
			OR = {
			has_tech = subtech_light_soviet_tank_art_1
			has_tech = subtech_light_soviet_tank_art_2
			has_tech= subtech_t_34_art_1
			has_tech= subtech_t_34_art_2
			has_tech= subtech_kv_tank_art_1
			has_tech= subtech_is_tank_art_1
			}
			OR = {
			has_tech = subtech_light_soviet_tank_td_1
			has_tech = subtech_light_soviet_tank_td_2
			has_tech = subtech_t_34_td_1
			has_tech = subtech_t_34_td_2
			has_tech= subtech_kv_tank_td_1
			has_tech= subtech_is_tank_td_1
			}
		}
		allowed = {
			tag = SOV
		}
		visible = {
		date > 1941.10.1
		}
		cost = 10
		icon = generic_political_actions

		ai_will_do = {
			factor = 8
		}	
		fire_only_once = yes
		complete_effect = {
			SOV = {
				country_event = SOV_tank_event.3
			}
		}

	}
	
	SOV_Mechanised_Corps_focus = {
		available = {
			date > 1942.9.1
			custom_trigger_tooltip = { tooltip = barba_13
		    	check_variable = {
			    	var = global.ostfront_year_4
			    	value = 13
			    	compare = greater_than_or_equals
		    	}
			}
			has_tech = mechanised_infantry
			OR = {
			has_tech = subtech_light_soviet_tank_art_1
			has_tech = subtech_light_soviet_tank_art_2
			has_tech= subtech_t_34_art_1
			has_tech= subtech_t_34_art_2
			has_tech= subtech_kv_tank_art_1
			has_tech= subtech_is_tank_art_1
			}
			OR = {
			has_tech = subtech_light_soviet_tank_td_1
			has_tech = subtech_light_soviet_tank_td_2
			has_tech = subtech_t_34_td_1
			has_tech = subtech_t_34_td_2
			has_tech= subtech_kv_tank_td_1
			has_tech= subtech_is_tank_td_1
			}
		}
		allowed = {
			tag = SOV
		}
		visible = {
		date > 1942.1.1
		}

		cost = 5
		icon = generic_political_actions

		ai_will_do = {
			factor = 5
		}	
		fire_only_once = yes
		complete_effect = {
			SOV = {
				country_event = SOV_tank_event.4
			}
		}
	}

	SOV_Tank_Corps_wave_four_focus = {
		available = {
			date > 1942.11.1
			custom_trigger_tooltip = { tooltip = barba_14
		    	check_variable = {
			    	var = global.ostfront_year_4
			    	value = 14
			    	compare = greater_than_or_equals
		    	}
			}
			OR = {
			has_tech = subtech_light_soviet_tank_art_1
			has_tech = subtech_light_soviet_tank_art_2
			has_tech= subtech_t_34_art_1
			has_tech= subtech_t_34_art_2
			has_tech= subtech_kv_tank_art_1
			has_tech= subtech_is_tank_art_1
			}
			OR = {
			has_tech = subtech_light_soviet_tank_td_1
			has_tech = subtech_light_soviet_tank_td_2
			has_tech = subtech_t_34_td_1
			has_tech = subtech_t_34_td_2
			has_tech= subtech_kv_tank_td_1
			has_tech= subtech_is_tank_td_1
			}
		}
		allowed = {
			tag = SOV
		}
		visible = {
		date > 1942.1.1
		}
		cost = 5
		icon = generic_political_actions

		ai_will_do = {
			factor = 8
		}	
		fire_only_once = yes
		complete_effect = {
			SOV = {
				country_event = SOV_tank_event.5
			}
		}

	}
	SOV_Tank_Corps_wave_five_focus = {
		available = {
			date > 1943.1.1
			custom_trigger_tooltip = { tooltip = barba_17
		    	check_variable = {
			    	var = global.ostfront_year_4
			    	value = 17
			    	compare = greater_than_or_equals
		    	}
			}
			OR = {
			has_tech = subtech_light_soviet_tank_art_1
			has_tech = subtech_light_soviet_tank_art_2
			has_tech= subtech_t_34_art_1
			has_tech= subtech_t_34_art_2
			has_tech= subtech_kv_tank_art_1
			has_tech= subtech_is_tank_art_1
			}
			OR = {
			has_tech = subtech_light_soviet_tank_td_1
			has_tech = subtech_light_soviet_tank_td_2
			has_tech = subtech_t_34_td_1
			has_tech = subtech_t_34_td_2
			has_tech= subtech_kv_tank_td_1
			has_tech= subtech_is_tank_td_1
			}
		}
		allowed = {
			tag = SOV
		}
		visible = {
		date > 1942.6.1
		}
		cost = 5
		icon = generic_political_actions

		ai_will_do = {
			factor = 5
		}	
		fire_only_once = yes
		complete_effect = {
			SOV = {
				country_event = SOV_tank_event.6
			}
		}

	}
	SOV_Tank_Corps_upgrade_one_focus = {
		available = {
			date > 1943.6.1
			custom_trigger_tooltip = { tooltip = barba_21
		    	check_variable = {
			    	var = global.ostfront_year_4
			    	value = 21
			    	compare = greater_than_or_equals
		    	}
			}
			OR = {
			has_tech = subtech_light_soviet_tank_art_1
			has_tech = subtech_light_soviet_tank_art_2
			has_tech= subtech_t_34_art_1
			has_tech= subtech_t_34_art_2
			has_tech= subtech_kv_tank_art_1
			has_tech= subtech_is_tank_art_1
			}
			OR = {
			has_tech = subtech_light_soviet_tank_td_1
			has_tech = subtech_light_soviet_tank_td_2
			has_tech = subtech_t_34_td_1
			has_tech = subtech_t_34_td_2
			has_tech= subtech_kv_tank_td_1
			has_tech= subtech_is_tank_td_1
			}
		}
		allowed = {
			tag = SOV
		}
		visible = {
		date > 1943.1.1
		}
		cost = 5
		icon = generic_political_actions

		ai_will_do = {
			factor = 3
		}	
		fire_only_once = yes
		complete_effect = {
			SOV = {
				country_event = SOV_tank_event.7
			}
		}

	}
	SOV_Tank_Corps_upgrade_two_focus = {
		available = {
			date > 1943.10.1
			custom_trigger_tooltip = { tooltip = barba_25
		    	check_variable = {
			    	var = global.ostfront_year_4
			    	value = 25
			    	compare = greater_than_or_equals
		    	}
			}
			OR = {
			has_tech = subtech_light_soviet_tank_art_1
			has_tech = subtech_light_soviet_tank_art_2
			has_tech= subtech_t_34_art_1
			has_tech= subtech_t_34_art_2
			has_tech= subtech_kv_tank_art_1
			has_tech= subtech_is_tank_art_1
			}
			OR = {
			has_tech = subtech_light_soviet_tank_td_1
			has_tech = subtech_light_soviet_tank_td_2
			has_tech = subtech_t_34_td_1
			has_tech = subtech_t_34_td_2
			has_tech= subtech_kv_tank_td_1
			has_tech= subtech_is_tank_td_1
			}
		}
		allowed = {
			tag = SOV
		}
		visible = {
		date > 1943.1.1
		}
		cost = 5
		icon = generic_political_actions

		ai_will_do = {
			factor = 3
		}	
		fire_only_once = yes
		complete_effect = {
			SOV = {
				country_event = SOV_tank_event.8
			}
		}

	}
	SOV_Tank_Corps_upgrade_three_focus = {
		available = {
			date > 1944.1.1
			custom_trigger_tooltip = { tooltip = barba_28
		    	check_variable = {
			    	var = global.ostfront_year_4
			    	value = 28
			    	compare = greater_than_or_equals
		    	}
			}
			OR = {
			has_tech = subtech_light_soviet_tank_art_1
			has_tech = subtech_light_soviet_tank_art_2
			has_tech= subtech_t_34_art_1
			has_tech= subtech_t_34_art_2
			has_tech= subtech_kv_tank_art_1
			has_tech= subtech_is_tank_art_1
			}
			OR = {
			has_tech = subtech_light_soviet_tank_td_1
			has_tech = subtech_light_soviet_tank_td_2
			has_tech = subtech_t_34_td_1
			has_tech = subtech_t_34_td_2
			has_tech= subtech_kv_tank_td_1
			has_tech= subtech_is_tank_td_1
			}
		}
		allowed = {
			tag = SOV
		}
		visible = {
		date > 1943.1.1
		}
		cost = 5
		icon = generic_political_actions

		cost = 5
		ai_will_do = {
			factor = 3
		}	
		fire_only_once = yes
		complete_effect = {
			SOV = {
				country_event = SOV_tank_event.9
			}
		}

	}
	SOV_Mechanised_Corps_II_focus = {
		available = {
			date > 1943.9.1
			custom_trigger_tooltip = { tooltip = barba_24
		    	check_variable = {
			    	var = global.ostfront_year_4
			    	value = 24
			    	compare = greater_than_or_equals
		    	}
			}
			has_tech = mechanised_infantry
			OR = {
			has_tech = subtech_light_soviet_tank_art_1
			has_tech = subtech_light_soviet_tank_art_2
			has_tech= subtech_t_34_art_1
			has_tech= subtech_t_34_art_2
			has_tech= subtech_kv_tank_art_1
			has_tech= subtech_is_tank_art_1
			}
			OR = {
			has_tech = subtech_light_soviet_tank_td_1
			has_tech = subtech_light_soviet_tank_td_2
			has_tech = subtech_t_34_td_1
			has_tech = subtech_t_34_td_2
			has_tech= subtech_kv_tank_td_1
			has_tech= subtech_is_tank_td_1
			}
		}
		allowed = {
			tag = SOV
		}
		visible = {
		date > 1943.1.1
		}
		cost = 5
		icon = generic_political_actions

		ai_will_do = {
			factor = 5
		}	
		fire_only_once = yes
		complete_effect = {
			SOV = {
				country_event = SOV_tank_event.10
			}
		}

	}
}
